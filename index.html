<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Comody Delivery</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>

<!-- ================================
     MODAL AUTH (LOGIN/REGISTRO)
     ================================ -->
<div class="modal-overlay" id="modalAuth">
    <div class="modal-auth">
        <button class="modal-close" onclick="cerrarModalAuth()">‚úï</button>
        
        <div class="auth-header">
            <div class="auth-logo">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 600 180" width="120" height="36">
                    <defs>
                        <style>
                            .cls-red { fill: #99404F; }
                            .cls-black { fill: #2e2e2e; }
                            .cls-white { fill: #ffffff; }
                            .font-condensed { 
                                font-family: 'Impact', 'Oswald', 'Arial Narrow', sans-serif; 
                                font-weight: normal; 
                                font-size: 140px;
                                font-stretch: condensed;
                                letter-spacing: 2px;
                            }
                        </style>
                    </defs>
                    <rect x="10" y="10" width="130" height="160" rx="10" ry="10" class="cls-red" />
                    <text x="75" y="140" text-anchor="middle" class="cls-white font-condensed">C</text>
                    <text x="160" y="140" class="cls-black font-condensed">OMODY</text>
                </svg>
            </div>
            <h2>Comody Delivery</h2>
        </div>
        
        <div class="auth-tabs">
            <button class="auth-tab active" onclick="mostrarTabAuth('login')">Iniciar Sesi√≥n</button>
            <button class="auth-tab" onclick="mostrarTabAuth('registro')">Crear Cuenta</button>
        </div>
        
        <!-- FORM LOGIN -->
        <div class="auth-body" id="formLogin">
            <div id="alertLogin" class="alert"></div>
            <form onsubmit="return handleLogin(event)">
                <div class="form-group">
                    <label>üìß Correo</label>
                    <input type="email" id="loginCorreo" placeholder="tu@correo.com" required>
                </div>
                <div class="form-group">
                    <label>üîí Contrase√±a</label>
                    <div class="password-wrapper">
                        <input type="password" id="loginContrasena" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                        <button type="button" class="toggle-password" onclick="togglePassword('loginContrasena', 'eyeIconLogin')">
                            <span id="eyeIconLogin">üëÅÔ∏è</span>
                        </button>
                    </div>
                </div>
                <button type="submit" class="btn-auth" id="btnLogin">
                    <span class="btn-text">Entrar</span>
                    <span class="btn-loader"></span>
                </button>
            </form>
        </div>
        
        <!-- FORM REGISTRO -->
        <div class="auth-body" id="formRegistro" style="display:none;">
            <div id="alertRegistro" class="alert"></div>
            <form onsubmit="return handleRegistro(event)">
                <div class="form-group">
                    <label>üë§ Nombre</label>
                    <input type="text" id="regNombre" placeholder="Tu nombre completo" required>
                </div>
                <div class="form-group">
                    <label>üì± Tel√©fono</label>
                    <input type="tel" id="regTelefono" placeholder="10 d√≠gitos" maxlength="10" required>
                </div>
                <div class="form-group">
                    <label>üìß Correo</label>
                    <input type="email" id="regCorreo" placeholder="tu@correo.com" required>
                </div>
                <div class="form-group">
                    <label>üîí Contrase√±a</label>
                    <div class="password-wrapper">
                        <input type="password" id="regContrasena" placeholder="M√≠nimo 4 caracteres" minlength="4" required>
                        <button type="button" class="toggle-password" onclick="togglePassword('regContrasena', 'eyeIconReg')">
                            <span id="eyeIconReg">üëÅÔ∏è</span>
                        </button>
                    </div>
                </div>
                <div class="form-group">
                    <label>üîí Confirmar</label>
                    <input type="password" id="regContrasena2" placeholder="Repite contrase√±a" required>
                </div>
                <button type="submit" class="btn-auth btn-registro" id="btnRegistro">
                    <span class="btn-text">Crear Cuenta</span>
                    <span class="btn-loader"></span>
                </button>
            </form>
        </div>
    </div>
</div>

<!-- ================================
     APP PRINCIPAL
     ================================ -->
<div id="appSection">
    
    <!-- HEADER -->
    <header class="header">
        <div class="header-content">
            <div class="header-left">
                <div class="header-logo">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 600 180" width="80" height="24">
                        <defs>
                            <style>
                                .cls-red { fill: #99404F; }
                                .cls-black { fill: #2e2e2e; }
                                .cls-white { fill: #ffffff; }
                                .font-condensed { 
                                    font-family: 'Impact', 'Oswald', 'Arial Narrow', sans-serif; 
                                    font-weight: normal; 
                                    font-size: 140px;
                                    font-stretch: condensed;
                                    letter-spacing: 2px;
                                }
                            </style>
                        </defs>
                        <rect x="10" y="10" width="130" height="160" rx="10" ry="10" class="cls-red" />
                        <text x="75" y="140" text-anchor="middle" class="cls-white font-condensed">C</text>
                        <text x="160" y="140" class="cls-black font-condensed">OMODY</text>
                    </svg>
                </div>
            </div>
            <div class="header-center">
                <div class="search-box">
                    <span>üîç</span>
                    <input type="text" id="searchInput" placeholder="Buscar..." oninput="buscarProductos()">
                </div>
            </div>
            <div class="header-right">
                <button class="btn-login-desktop" id="btnLoginDesktop" onclick="abrirModalAuth()" style="display:none;">Iniciar Sesi√≥n</button>
                <div class="user-points" id="userPoints">‚≠ê 0</div>
                <div class="user-btn" onclick="toggleUserMenu()">
                    <span id="userInitial">?</span>
                </div>
                <div class="cart-btn" onclick="toggleCart()">
                    üõí <span class="cart-badge" id="cartBadge">0</span>
                </div>
            </div>
        </div>
    </header>

    <!-- USER MENU DROPDOWN -->
    <div class="user-menu" id="userMenu">
        <div class="user-menu-header">
            <strong id="menuUserName">Usuario</strong>
            <span id="menuUserEmail">correo@email.com</span>
        </div>
        <div class="user-menu-item" onclick="mostrarSeccion('menu')">üçΩÔ∏è Men√∫</div>
        <div class="user-menu-item" onclick="mostrarSeccion('pedidos')">üì¶ Mis Pedidos</div>
        <div class="user-menu-item logout" onclick="logout()">üö™ Cerrar Sesi√≥n</div>
    </div>

    <!-- ================================
         SECCION MENU
         ================================ -->
    <main class="main" id="seccionMenu">
        <!-- BANNERS PRINCIPALES -->
        <div class="banners-container" id="bannersContainer">
            <div class="banners-slider" id="bannersSlider"></div>
            <div class="banners-dots" id="bannersDots"></div>
        </div>
        
        <!-- PROMOCIONES -->
        <section class="promociones-section" id="promocionesSection" style="display:none;">
            <div class="section-header">
                <h2>üî• Promociones</h2>
                <span class="promo-timer" id="promoTimer"></span>
            </div>
            <div class="promociones-scroll">
                <div class="promociones-container" id="promocionesContainer"></div>
            </div>
        </section>
        
        <!-- M√ÅS VENDIDOS / DESTACADOS -->
        <section class="destacados-section" id="destacadosSection" style="display:none;">
            <div class="section-header">
                <h2>üèÜ M√°s Vendidos</h2>
            </div>
            <div class="destacados-scroll">
                <div class="destacados-container" id="destacadosContainer"></div>
            </div>
        </section>
        
        <!-- √öLTIMOS VISTOS -->
        <section class="ultimos-vistos-section" id="ultimosVistosSection" style="display:none;">
            <div class="section-header">
                <h2>üëÄ Vistos recientemente</h2>
            </div>
            <div class="ultimos-scroll">
                <div class="ultimos-container" id="ultimosVistosContainer"></div>
            </div>
        </section>
        
        <!-- BANNER SECUNDARIO -->
        <div class="banner-secundario" id="bannerSecundario" style="display:none;">
            <img id="bannerSecundarioImg" src="" alt="">
        </div>
        
        <!-- CHIPS DE CATEGOR√çAS (filtro r√°pido) -->
        <div class="categories" id="categoriesContainer"></div>
        
        <!-- PRODUCTOS -->
        <section class="products-section">
            <div class="products-header">
                <h2 id="categoryTitle">Todos los Platillos</h2>
                <div class="products-header-right">
                    <span id="productsCount">0 productos</span>
                    <div class="view-toggle">
                        <button class="view-btn active" id="btnViewGrid" onclick="cambiarVista('grid')" title="Cuadr√≠cula">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                <rect x="3" y="3" width="7" height="7" rx="1"/>
                                <rect x="14" y="3" width="7" height="7" rx="1"/>
                                <rect x="3" y="14" width="7" height="7" rx="1"/>
                                <rect x="14" y="14" width="7" height="7" rx="1"/>
                            </svg>
                        </button>
                        <button class="view-btn" id="btnViewList" onclick="cambiarVista('list')" title="Lista">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                <rect x="3" y="4" width="18" height="4" rx="1"/>
                                <rect x="3" y="10" width="18" height="4" rx="1"/>
                                <rect x="3" y="16" width="18" height="4" rx="1"/>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
            <div class="products-grid" id="productsGrid">
                <div class="loading">
                    <div class="spinner"></div>
                    <p>Cargando productos...</p>
                </div>
            </div>
        </section>
        
        <!-- BANNER TERCIARIO (al final) -->
        <div class="banner-terciario" id="bannerTerciario" style="display:none;">
            <img id="bannerTerciarioImg" src="" alt="">
        </div>
        
        <!-- PRODUCTOS POR CATEGOR√çA -->
        <section class="productos-por-categoria" id="productosPorCategoria"></section>
    </main>
    
    <!-- FOOTER INFO -->
    <footer class="footer-info">
        <div class="footer-logo">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 600 180" width="150" height="45">
                <defs>
                    <style>
                        .cls-red-footer { fill: #ffffff; }
                        .cls-black-footer { fill: rgba(255,255,255,0.9); }
                        .cls-white-footer { fill: #2e2e2e; }
                        .font-condensed { 
                            font-family: 'Impact', 'Oswald', 'Arial Narrow', sans-serif; 
                            font-weight: normal; 
                            font-size: 140px;
                            font-stretch: condensed;
                            letter-spacing: 2px;
                        }
                    </style>
                </defs>
                <rect x="10" y="10" width="130" height="160" rx="10" ry="10" class="cls-red-footer" />
                <text x="75" y="140" text-anchor="middle" class="cls-white-footer font-condensed">C</text>
                <text x="160" y="140" class="cls-black-footer font-condensed">OMODY</text>
            </svg>
            <p style="margin-top: 10px; font-size: 13px; opacity: 0.8;">Delivery</p>
        </div>
        <p>Tu comida favorita en minutos</p>
        <!-- BOT√ìN TEMPORAL DE LIMPIEZA -->
        <button onclick="if(confirm('¬øLimpiar sesi√≥n?')){localStorage.clear();location.reload();}" style="margin: 10px auto; padding: 8px 16px; background: #ef4444; color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 11px;">
            üîß Limpiar Datos
        </button>
        <div class="footer-social">
            <a href="#" class="social-btn">üìò</a>
            <a href="#" class="social-btn">üì∏</a>
            <a href="#" class="social-btn">üí¨</a>
        </div>
        <p class="footer-copy">¬© 2025 Comody. Todos los derechos reservados.</p>
    </footer>

    <!-- ================================
         SECCION MIS PEDIDOS
         ================================ -->
    <main class="main" id="seccionPedidos" style="display:none;">
        <div class="section-title">
            <h2>üì¶ Mis Pedidos</h2>
        </div>
        <div id="pedidosList" class="pedidos-list">
            <div class="loading">
                <div class="spinner"></div>
                <p>Cargando...</p>
            </div>
        </div>
    </main>

    <!-- ================================
         CARRITO FLOTANTE
         ================================ -->
    <div class="carrito-flotante" id="carritoFlotante" onclick="toggleCart()" style="display:none;">
        <div class="carrito-flotante-icon">üõí</div>
        <div class="carrito-flotante-info">
            <span class="carrito-flotante-items" id="flotanteItems">0 items</span>
            <span class="carrito-flotante-total" id="flotanteTotal">$0.00</span>
        </div>
        <div class="carrito-flotante-btn">Ver carrito</div>
    </div>

    <!-- ================================
         FOOTER MOBILE
         ================================ -->
    <nav class="footer-mobile" id="footerMobile">
        <div class="footer-item active" onclick="navegar('menu')">
            <span class="footer-icon">üçΩÔ∏è</span>
            <span class="footer-label">Men√∫</span>
        </div>
        <div class="footer-item" onclick="navegar('pedidos')">
            <span class="footer-icon">üì¶</span>
            <span class="footer-label">Pedidos</span>
        </div>
        <div class="footer-item" onclick="toggleCart()">
            <span class="footer-icon">üõí</span>
            <span class="footer-badge" id="footerCartBadge">0</span>
            <span class="footer-label">Carrito</span>
        </div>
        <div class="footer-item" onclick="navegar('cuenta')">
            <span class="footer-icon">üë§</span>
            <span class="footer-label" id="footerCuentaLabel">Cuenta</span>
        </div>
    </nav>

    <!-- ================================
         CART SIDEBAR
         ================================ -->
    <div class="cart-overlay" id="cartOverlay" onclick="toggleCart()"></div>
    <aside class="cart-sidebar" id="cartSidebar">
        <div class="cart-header">
            <h3>üõí Mi Pedido</h3>
            <button onclick="toggleCart()">‚úï</button>
        </div>
        <div class="cart-items" id="cartItems">
            <div class="cart-empty">
                <span>üõí</span>
                <p>Tu carrito est√° vac√≠o</p>
            </div>
        </div>
        <div class="cart-footer" id="cartFooter" style="display:none;">
            <div class="cart-totals">
                <div class="cart-row">
                    <span>Subtotal:</span>
                    <span id="cartSubtotal">$0.00</span>
                </div>
                <div class="cart-row" id="cartEnvioRow" style="display:none;">
                    <span>Env√≠o:</span>
                    <span id="cartEnvio">$0.00</span>
                </div>
                <div class="cart-row total">
                    <span>Total:</span>
                    <span id="cartTotal">$0.00</span>
                </div>
            </div>
            <button class="btn-checkout" onclick="abrirCheckout()">Continuar</button>
        </div>
    </aside>
</div>

<!-- ================================
     MODALES
     ================================ -->

<!-- MODAL CUPON AUTOMATICO -->
<div class="modal-overlay" id="modalCupon">
    <div class="modal-cupon">
        <button class="modal-close" onclick="cerrarModalCupon()">‚úï</button>
        <div class="cupon-imagen" id="cuponImagen"></div>
        <div class="cupon-body">
            <div class="cupon-badge">üéâ OFERTA ESPECIAL</div>
            <h2 id="cuponNombre">Cup√≥n de Descuento</h2>
            <div class="cupon-descuento" id="cuponDescuento">-20%</div>
            <p class="cupon-vigencia" id="cuponVigencia">V√°lido hasta: --</p>
            <button class="btn-aplicar-cupon" onclick="aplicarCuponAutomatico()">¬°Lo quiero!</button>
            <button class="btn-ignorar-cupon" onclick="cerrarModalCupon()">Ahora no</button>
        </div>
    </div>
</div>

<!-- MODAL CUENTA -->
<div class="modal-overlay" id="modalCuenta">
    <div class="modal-cuenta">
        <div class="cuenta-header">
            <div class="cuenta-avatar" id="cuentaAvatar">U</div>
            <div class="cuenta-info">
                <h3 id="cuentaNombre">Usuario</h3>
                <p id="cuentaCorreo">correo@email.com</p>
            </div>
        </div>
        <div class="cuenta-puntos">
            <span>‚≠ê</span>
            <span id="cuentaPuntos">0</span>
            <span>puntos</span>
        </div>
        <div class="cuenta-menu">
            <div class="cuenta-item" onclick="editarPerfil()">
                <span>üë§</span>
                <span>Mi Perfil</span>
                <span class="cuenta-arrow">‚Ä∫</span>
            </div>
            <div class="cuenta-item" onclick="navegar('pedidos'); cerrarCuenta();">
                <span>üì¶</span>
                <span>Mis Pedidos</span>
                <span class="cuenta-arrow">‚Ä∫</span>
            </div>
            <div class="cuenta-item" onclick="verDirecciones()">
                <span>üìç</span>
                <span>Mis Direcciones</span>
                <span class="cuenta-arrow">‚Ä∫</span>
            </div>
            <div class="cuenta-item logout" onclick="logout()">
                <span>üö™</span>
                <span>Cerrar Sesi√≥n</span>
            </div>
        </div>
        <button class="btn-cerrar-cuenta" onclick="cerrarCuenta()">Cerrar</button>
    </div>
</div>

<!-- MODAL EDITAR PERFIL -->
<div class="modal-overlay" id="modalEditarPerfil">
    <div class="modal-auth">
        <button class="modal-close" onclick="cerrarEditarPerfil()">‚úï</button>
        
        <div class="auth-header">
            <div class="auth-logo">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 600 180" width="120" height="36">
                    <defs>
                        <style>
                            .cls-red { fill: #99404F; }
                            .cls-black { fill: #2e2e2e; }
                            .cls-white { fill: #ffffff; }
                            .font-condensed { 
                                font-family: 'Impact', 'Oswald', 'Arial Narrow', sans-serif; 
                                font-weight: normal; 
                                font-size: 140px;
                                font-stretch: condensed;
                                letter-spacing: 2px;
                            }
                        </style>
                    </defs>
                    <rect x="10" y="10" width="130" height="160" rx="10" ry="10" class="cls-red" />
                    <text x="75" y="140" text-anchor="middle" class="cls-white font-condensed">C</text>
                    <text x="160" y="140" class="cls-black font-condensed">OMODY</text>
                </svg>
            </div>
            <h2>Editar Mi Perfil</h2>
        </div>
        
        <div class="auth-body">
            <div id="alertEditarPerfil" class="alert"></div>
            <form onsubmit="return handleEditarPerfil(event)">
                <div class="form-group">
                    <label>üë§ Nombre</label>
                    <input type="text" id="editNombre" placeholder="Tu nombre completo" required>
                </div>
                <div class="form-group">
                    <label>üì± Tel√©fono</label>
                    <input type="tel" id="editTelefono" placeholder="10 d√≠gitos" maxlength="10" required>
                </div>
                <div class="form-group">
                    <label>üìß Correo</label>
                    <input type="email" id="editCorreo" placeholder="tu@correo.com" readonly style="opacity: 0.6; cursor: not-allowed;">
                    <small style="font-size: 10px; color: var(--gray-500); margin-top: 4px; display: block;">El correo no se puede cambiar</small>
                </div>
                <div class="form-group">
                    <label>üîí Nueva Contrase√±a (opcional)</label>
                    <div class="password-wrapper">
                        <input type="password" id="editContrasena" placeholder="Dejar vac√≠o para no cambiar">
                        <button type="button" class="toggle-password" onclick="togglePassword('editContrasena', 'eyeIconEdit')">
                            <span id="eyeIconEdit">üëÅÔ∏è</span>
                        </button>
                    </div>
                </div>
                <div class="form-group">
                    <label>üîí Confirmar Contrase√±a</label>
                    <input type="password" id="editContrasena2" placeholder="Confirmar nueva contrase√±a">
                </div>
                <button type="submit" class="btn-auth btn-registro" id="btnEditarPerfil">
                    <span class="btn-text">Guardar Cambios</span>
                    <span class="btn-loader"></span>
                </button>
            </form>
        </div>
    </div>
</div>

<!-- MODAL DIRECCIONES -->
<div class="modal-overlay" id="modalDirecciones">
    <div class="modal-direcciones">
        <div class="modal-dir-header">
            <h3>üìç Mis Direcciones</h3>
            <button class="modal-close" onclick="cerrarModalDirecciones()">‚úï</button>
        </div>
        <div class="modal-dir-body">
            <div class="direcciones-lista" id="direccionesLista">
                <div class="loading-mini"><span>Cargando...</span></div>
            </div>
            <div class="direccion-form" id="direccionForm" style="display:none;">
                <h4 id="direccionFormTitulo">Nueva Direcci√≥n</h4>
                <input type="hidden" id="direccionEditId">
                <div class="form-group">
                    <label>Direcci√≥n completa</label>
                    <textarea id="direccionInput" placeholder="Calle, n√∫mero, colonia, referencias..." rows="3"></textarea>
                </div>
                <div class="form-group">
                    <button class="btn-ubicacion-dir" onclick="obtenerUbicacionDireccion()">
                        <span id="ubicacionDirIcon">üìç</span>
                        <span id="ubicacionDirText">Agregar ubicaci√≥n GPS</span>
                    </button>
                    <input type="hidden" id="direccionMaps">
                    <div class="coords-info" id="coordsDirInfo" style="display:none;">‚úÖ Ubicaci√≥n guardada</div>
                </div>
                <div class="form-actions">
                    <button class="btn-cancelar" onclick="cancelarFormDireccion()">Cancelar</button>
                    <button class="btn-guardar" id="btnGuardarDir" onclick="guardarDireccion()">Guardar</button>
                </div>
            </div>
        </div>
        <div class="modal-dir-footer" id="modalDirFooter">
            <button class="btn-agregar-direccion" onclick="mostrarFormNuevaDireccion()">
                <span>+</span> Agregar nueva direcci√≥n
            </button>
        </div>
    </div>
</div>

<!-- MODAL PRODUCTO -->
<div class="modal-overlay" id="modalProducto">
    <div class="modal-producto">
        <button class="modal-close" onclick="cerrarModal()">‚úï</button>
        <div class="modal-imagen" id="modalImagen"></div>
        <div class="modal-info">
            <h2 id="modalNombre">Producto</h2>
            <p id="modalDescripcion">Descripci√≥n</p>
            <div class="modal-precio" id="modalPrecio">$0.00</div>
            <div class="modal-tiempo">‚è±Ô∏è <span id="modalTiempo">15 min</span></div>
            
            <div class="extras-section" id="extrasSection" style="display:none;">
                <h4>Extras disponibles</h4>
                <div class="extras-list" id="extrasList"></div>
            </div>
            
            <div class="notas-section">
                <h4>üìù Notas especiales</h4>
                <textarea id="modalNotas" placeholder="Ej: Sin cebolla, t√©rmino medio..." rows="2"></textarea>
            </div>
            
            <div class="modal-cantidad">
                <span>Cantidad:</span>
                <div class="cantidad-ctrl">
                    <button onclick="cambiarCantidad(-1)">‚àí</button>
                    <span id="modalCantidad">1</span>
                    <button onclick="cambiarCantidad(1)">+</button>
                </div>
            </div>
            
            <div class="modal-total">
                <span>Total:</span>
                <span id="modalTotal">$0.00</span>
            </div>
            
            <!-- PRODUCTOS SIMILARES -->
            <div class="similares-section" id="similaresSection" style="display:none;">
                <h4>Tambi√©n te puede gustar</h4>
                <div class="similares-scroll">
                    <div class="similares-container" id="similaresContainer"></div>
                </div>
            </div>
            
            <button class="btn-agregar" onclick="agregarAlCarrito()">üõí Agregar al Pedido</button>
        </div>
    </div>
</div>

<!-- MODAL PROMOCION -->
<div class="modal-overlay" id="modalPromocion">
    <div class="modal-promo">
        <button class="modal-close" onclick="cerrarModalPromo()">‚úï</button>
        <div class="promo-modal-imagen" id="promoModalImagen"></div>
        <div class="promo-modal-body">
            <div class="promo-modal-badge" id="promoModalBadge">-20%</div>
            <h2 id="promoModalNombre">Combo Familiar</h2>
            <p class="promo-modal-desc" id="promoModalDesc">Descripci√≥n del combo</p>
            
            <div class="promo-modal-productos">
                <h4>Incluye:</h4>
                <div class="promo-productos-lista" id="promoProductosLista"></div>
            </div>
            
            <div class="promo-modal-precios">
                <span class="promo-precio-normal" id="promoModalPrecioNormal">$380.00</span>
                <span class="promo-precio-promo" id="promoModalPrecioPromo">$299.00</span>
            </div>
            
            <div class="promo-modal-ahorro" id="promoModalAhorro">¬°Ahorras $81.00!</div>
            
            <div class="promo-modal-cantidad">
                <button class="qty-btn" onclick="cambiarCantidadPromo(-1)">‚àí</button>
                <span id="promoModalCantidad">1</span>
                <button class="qty-btn" onclick="cambiarCantidadPromo(1)">+</button>
            </div>
            
            <button class="btn-agregar-promo" onclick="agregarPromoAlCarrito()">
                <span>Agregar al carrito</span>
                <span id="promoModalTotal">$299.00</span>
            </button>
        </div>
    </div>
</div>

<!-- MODAL CHECKOUT -->
<div class="modal-overlay" id="modalCheckout">
    <div class="modal-checkout">
        <button class="modal-close" onclick="cerrarCheckout()">‚úï</button>
        <div class="checkout-header">
            <h2>üìç Finalizar Pedido</h2>
        </div>
        <div class="checkout-body">
            
            <!-- Tipo de servicio -->
            <div class="checkout-section">
                <h4>Tipo de servicio</h4>
                <div class="tipo-servicio-btns">
                    <button class="tipo-btn active" onclick="selectTipoServicio('Domicilio')">üè† Domicilio</button>
                    <button class="tipo-btn" onclick="selectTipoServicio('Recoger')">üè™ Recoger</button>
                </div>
            </div>
            
            <!-- Cup√≥n -->
            <div class="checkout-section">
                <h4>üè∑Ô∏è Cup√≥n de descuento</h4>
                <div class="cupon-aplicado" id="cuponAplicadoInfo" style="display:none;">
                    <div class="cupon-aplicado-badge">
                        <span class="cupon-aplicado-nombre" id="checkoutCuponNombre">DESCUENTO20</span>
                        <span class="cupon-aplicado-descuento" id="checkoutCuponDescuento">-20%</span>
                    </div>
                    <button class="btn-quitar-cupon" onclick="quitarCupon()">‚úï</button>
                </div>
                <div class="cupon-input-wrapper" id="cuponInputWrapper">
                    <input type="text" id="inputCupon" placeholder="Ingresa tu c√≥digo" maxlength="20">
                    <button class="btn-validar-cupon" id="btnValidarCupon" onclick="validarCuponManual()">Aplicar</button>
                </div>
                <div class="cupon-error" id="cuponError" style="display:none;"></div>
            </div>
            
            <!-- Tel√©fono -->
            <div class="checkout-section">
                <h4>üì± Tel√©fono de contacto</h4>
                <input type="tel" id="checkoutTelefono" placeholder="10 d√≠gitos" maxlength="10">
            </div>
            
            <!-- Direcci√≥n -->
            <div class="checkout-section" id="seccionDireccion">
                <h4>üìç Direcci√≥n de entrega</h4>
                <div class="direcciones-guardadas" id="direccionesGuardadas">
                    <div class="loading-mini"><span>Cargando...</span></div>
                </div>
                <div class="nueva-direccion" id="nuevaDireccionForm" style="display:none;">
                    <textarea id="checkoutDireccion" placeholder="Calle, n√∫mero, colonia, referencias..." rows="2"></textarea>
                    <button class="btn-ubicacion" onclick="obtenerUbicacion()">
                        <span id="ubicacionIcon">üìç</span>
                        <span id="ubicacionText">Usar mi ubicaci√≥n</span>
                    </button>
                    <input type="hidden" id="checkoutCoordenadas">
                    <div class="coordenadas-info" id="coordenadasInfo" style="display:none;">‚úÖ Ubicaci√≥n capturada</div>
                    <div class="nueva-direccion-btns">
                        <button class="btn-guardar-dir" onclick="guardarNuevaDireccion()">üíæ Guardar</button>
                        <button class="btn-cancelar-dir" onclick="cancelarNuevaDireccion()">‚úï Cancelar</button>
                    </div>
                </div>
                <button class="btn-agregar-dir" id="btnAgregarDir" onclick="mostrarFormDireccion()">+ Agregar nueva direcci√≥n</button>
            </div>
            
            <!-- Observaciones -->
            <div class="checkout-section">
                <h4>üìã Observaciones del pedido</h4>
                <textarea id="checkoutObservaciones" placeholder="Instrucciones especiales..." rows="2"></textarea>
            </div>
            
            <!-- Resumen -->
            <div class="checkout-resumen">
                <h4>Resumen</h4>
                <div id="checkoutItems"></div>
                <div class="checkout-totals">
                    <div class="checkout-row">
                        <span>Subtotal:</span>
                        <span id="checkoutSubtotal">$0.00</span>
                    </div>
                    <div class="checkout-row" id="checkoutEnvioRow">
                        <span>Env√≠o:</span>
                        <span id="checkoutEnvio">$0.00</span>
                    </div>
                    <div class="checkout-row descuento" id="checkoutDescuentoRow" style="display:none;">
                        <span>Descuento:</span>
                        <span id="checkoutDescuento">-$0.00</span>
                    </div>
                    <div class="checkout-row total">
                        <span>Total:</span>
                        <span id="checkoutTotal">$0.00</span>
                    </div>
                </div>
            </div>
        </div>
        <div class="checkout-footer">
            <button class="btn-confirmar" id="btnConfirmar" onclick="confirmarPedido()">‚úì Confirmar Pedido</button>
        </div>
    </div>
</div>

<!-- MODAL EXITO -->
<div class="modal-overlay" id="modalExito">
    <div class="modal-exito">
        <div class="exito-icon">‚úÖ</div>
        <h2>¬°Pedido Enviado!</h2>
        <div class="exito-folio" id="exitoFolio">PED00001</div>
        <p>Tu pedido est√° siendo preparado.<br>Te notificaremos cuando est√© listo.</p>
        <button class="btn-primary" onclick="cerrarExito()">Entendido</button>
    </div>
</div>

<script src="security-layer.js"></script>
<script src="script.js"></script>
</body>
</html>
